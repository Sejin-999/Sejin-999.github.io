---
title: CS - REST
date: 2024-01-29 06:44:00 +09:00
categories:
  - cs
tags:
  - [cs,REST, GET vs POST , PUT vs PATCH ]
---
## 들어가며

REST *REpresentational State Transfer 의 약어 입니다.* 

*REpresentational - 어떤 리소스의 특정 시점의 상태를 반영하고 있는 것을 말합니다.*

HTTP 에서도 representation 을 반영하는데 크게 data와 metaData를 가지고 있습니다.

지금 가지고 있는 data와 이의 대한 정보로써 metaData를 가지고 있는 것을 의미하는데

REST 에서의 representation 도 결국 현재의 상태를 의미하는 즉, 자원을 중심으로 한 표현이다 라는 뜻으로 이해할 수 있습니다.

정리하면 자원의 표현을 통해 상태(데이터)를 주고 받는 아키텍처 스타일을 REST라고 합니다.

즉, 인테넷을 통해 서로 다른 어플리케이션 - API 간에 데이터를 교환하는 방법을 정의하는 것입니다.

## 주요특징

- **자원**: REST는 문서, 이미지, 심지어 작업과 같은 식별 가능한 엔터티인 자원에 중점을 둡니다.
- **무상태**: 클라이언트에서 서버로의 각 요청은 독립적이어야 하며 이전 요청의 상태에 의존해서는 안 됩니다.
- **클라이언트 및 서버**: REST는 클라이언트와 서버의 역할을 분리합니다. 클라이언트는 서버의 리소스를 가져오거나, 생성하거나, 업데이트하거나, 삭제하기 위한 요청을 시작합니다.
- **HTTP 메서드**: REST는 GET, POST, PUT 및 DELETE와 같은 표준 HTTP 메서드를 활용하여 리소스에 대한 CRUD(Create, Read, Update, Delete) 작업을 수행합니다.
- **표현**: 리소스는 JSON, XML 또는 HTML과 같은 클라이언트와 서버 모두에서 이해할 수 있는 형식으로 표현됩니다.

## RESTFULL?

rest라는 정보교환 방식을 잘 지켜서 만들었다면 이것을 restFull한 아키텍처다 라는 의미입니다.

우리가 주로 사용하는 HTTP 메서드를  REST라는 규칙에 잘 지켜서 주고받는 것을 restFull하다고 표현할 수 있습니다. 결국 이를 받는 기기입장 - 그걸 개발하는 개발자 입장에서 생각을 해봤을 때 메서드 만으로도 대강 이 API가 어떤 것을 지원하는 구나 라는것을 알리기 위해서 RESTFULL이 강조된다고 생각합니다. 말 그대로 규칙이기 때문입니다. 규칙을 잘지키면 상대방이 잘 이해할 있을 것이기 때문입니다. 

## 표현 매체에 대한 생각

최근에 개발자들을 대체로 JSON을 통해 정보를 주고받습니다. 

예전에는 XML을 사용했고 아주 특정한 경우 HTML 테크 자체를 날리는 경우도 존재하긴 했습니다. 물론 HTML 테크를 날리는 것이 해당하는 어플리케이션의 특정 시점에 필요한 자원인 경우일 수 도 있겠지만, 좋은 방법은 아니라고 생각합니다. 만약 프론트 페이지에서 해당 부분의 수정이 발생하면 백엔드 API 에서 제공하는 데이터도 수정이 필요하고 이럴 경우 두 작업 단위의 종속이 발생하게 되는데 이는 결합도를 줄이기 위해 노력하는 모던 개발 방식의 위배 되는 경우 이기 때문입니다.

XML의 경우에도 정보 뿐만 아니라 이를 식별하기 위해 JSON 보다 더 많은 글을 포함하게 되는데 이때문에 최근에 사용이 되고 있지 않는 이유이기도 합니다.

 

## JSON

JSON (JavaScript Object Notation)

이는 키 - 벨류 형식으로 기본적인 데이터 형식 (우리가 흔히 쓰는 원시타입의 자료구조 형태)는 모두 지원한다고 봐도 무방합니다.

만약 array형태로 값을 준다면 [] , 여러개를 준다면 {} , 구분을 할때는 ; 을 사용할 수 있습니다.

## HTTP 메서드 종류 및 활용

일반적으로 웹은 http를 통해 통신하게 됩니다. (아주 특수한 경우를 제외)

그래서 HTTP의 메서드를 이해하는 것이 중요한데 크게 8가지로 볼 수 있습니다.

다만 실제로는 4개면 충분히 구현 가능하고 정말 러프하게 한다면 2개로도 할 수 있습니다.

다만, RESTFULL 한 아키텍처라고 말하기에는 어렵습니다.

저도 프로젝트를 하며 느꼈지만 사실 4개 이외에는 딱히 사용해 본 경험이 없었던 것 같긴 합니다.

GET , POST , PUT ,DELETE만 사용해도 어지간한 API 목록 - 개발한 기능에 대한 설명이 가능해서 라고 생각합니다.

그래도 일단 무엇이 있는지는 알고 만약 필요할 수 도 있으니 정리하겠습니다.

**1. GET**: 리소스 조회

가장 기본적인 HTTP 메서드로, 특정 URL에 해당하는 리소스의 정보를 조회하는 데 사용됩니다. 웹 브라우저에서 주소창에 URL을 입력하면 GET 메서드가 사용됩니다.

예시:

`GET /users/123`

**2. POST**: 데이터 생성, 등록

새로운 데이터를 서버에 전송하고 저장하는 데 사용됩니다. 회원 가입, 댓글 작성, 게시물 업로드와 같은 작업에 사용됩니다.

데이터는 일반적으로 메시지 본문에 포함된 형식으로 전송됩니다.

예시:

`POST /users
Content-Type: application/json

{
  "name": "John Doe",
  "email": "johndoe@example.com",
  "password": "123456"
}`

**3. PUT**: 리소스 수정, 대체

기존 리소스를 새로운 데이터로 완전히 수정하는 데 사용됩니다. 기존 리소스가 존재하지 않으면 새 리소스를 생성하는 것과 동일한 효과를 갖습니다.

예시:

`PUT /users/123
Content-Type: application/json

{
  "name": "Jane Doe",
  "email": "janedoe@example.com"
}`

**4. PATCH**: 리소스 부분 수정

기존 리소스의 일부만 변경하는 데 사용됩니다. PUT 메서드와 달리 전체 리소스를 대체하지 않고 특정 필드만 업데이트합니다.

예시:

`PATCH /users/123
Content-Type: application/json

{
  "email": "janedoe@example.com"
}`

**5. DELETE**: 리소스 삭제

특정 URL에 해당하는 리소스를 삭제하는 데 사용됩니다.

예시:

`DELETE /users/123`

**6. HEAD**: 리소스 정보만 조회

GET 메서드와 유사하지만, 리소스 본문 대신 메타데이터만을 반환합니다. 리소스가 존재하는지 확인하거나, 리소스의 마지막 수정 날짜나 크기를 확인하는 데 유용합니다.

예시:

`HEAD /users/123`

**7. OPTIONS**: 허용되는 HTTP 메서드 확인

특정 URL에 대해 허용되는 HTTP 메서드를 확인하는 데 사용됩니다.

예시:

`OPTIONS /users/123`

**8. TRACE**: 요청 경로 추적

클라이언트 요청이 서버를 거쳐 어떻게 처리되는지 추적하는 데 사용됩니다. 디버깅 목적으로 사용됩니다.

예시:

`TRACE /users/123`

## GET VS POST

**요청 유형:**

- **GET**: 정보 검색 및 리소스 조회에 사용됩니다. 서버 상태를 변경하지 않습니다. "정보를 가져와" 요청과 유사합니다.
- **POST**: 데이터 전송 및 리소스 생성 또는 업데이트에 사용됩니다. 서버 상태를 변경합니다. "정보를 제공하거나 작업을 수행하라" 요청과 유사합니다.

저는 스프링에서 주로 이런 정보를 제공하는 API를 만들고 있습니다. 그래서 GET 요청에 경우 DAO , POST 요청에 경우 DTO를 통해 구분지어서  Object를 관리하는데요.  이 두가지만 구분해 두어도 햇갈리는 경우를 정말 많이 방지할 수 있어서 선호해서 사용하고 있습니다.

**데이터 전송:**

- **GET**: 요청 URL에 데이터를 포함합니다. 데이터 길이 제한이 있을 수 있습니다.
- **POST**: 요청 본문에 데이터를 포함합니다. 더 많은 양의 데이터 전송에 적합합니다.

우리가 일반적으로 GET은 URL에 POST는 BODY에 실어서 보낸다 라고 이야기하는데요

저도 이렇게 알고 있었는데 개발을 하던중 GET - POST 를 바꾸고 Body를 받는 requestBody 어노테이션을 붙여두고 돌려본 경험이 있습니다. 사실 실수 였는데 JSON을 보내도 그대로 동작하길래 어? 알던거랑 다르긴하네 라고 생각이들었습니다.

사실 우리가 이야기하는 HTTP 메서드, REST는 결국 규칙이라 내가 일케 하겠다는데 하고 만들어 버리면 만들어집니다. 즉, 엄격하게 금지되는 경우가 아니라면 권장하지  않는다는 거지 되긴 하는 것 입니다.

결국 데이터 전송은 저런 식으로 **권장** 하는 거지 절대적인 것은 아닙니다.

**캐싱:**

- **GET**: 브라우저 및 서버에서 캐싱될 가능성이 높습니다. 반복적인 요청을 줄여 성능 향상에 도움이 됩니다.
- **POST**: 일반적으로 캐싱되지 않습니다. 매번 서버에 최신 데이터를 요청합니다.

앞서 말한 그럼 GET에 Body 실어서 해야지 이래버리면 브라우저 에서 캐싱이 되지 않습니다.

캐싱 이라는게 캐시를 만든다는 것인데 이게 요청을 보내기 전에 임시로 저장된 어떤 값들 중 해당 하는 값이 있으면 요청을 보내지 않고도 처리할 수 있습니다. 그래서 정보를 조회할 때는 GET 메서드를 쓰라는 것입니다. 

**보안:**

- **GET**: 민감한 데이터 전송에 적합하지 않습니다. 요청 URL에 데이터가 노출되기 때문입니다.
- **POST**: 보다 안전한 방법으로 데이터 전송에 사용됩니다. 요청 본문에 데이터가 포함되어 있기 때문에 URL에 노출되지 않습니다.

**결론:**

- **GET**은 정보 검색 및 리소스 조회에 사용되는 **읽기 전용** 메서드입니다.
- **POST**는 데이터 전송 및 리소스 생성 또는 업데이트에 사용되는 **쓰기** 메서드입니다.

적절한 메서드 선택은 요청의 목적과 데이터 유형에 따라 달라집니다. 

민감한 데이터를 전송하거나 서버 상태를 변경해야 하는 경우 **POST**를 사용하는 것이 좋습니다. 

그렇지 않은 경우 **GET**을 사용하는 것이 일반적으로 더 효율적입니다.

## PUT vs PATCH

**요청 유형:**

- **PUT**: 전체 리소스를 대체하는 **완전 업데이트** 요청입니다. "리소스를 이 새 데이터로 완전히 바꿔라" 요청과 유사합니다.
- **PATCH**: 리소스의 일부만 업데이트하는 **부분 업데이트** 요청입니다. "이 리소스의 특정 필드를 업데이트하라" 요청과 유사합니다.

모든 경우를 바꾸지 않고, 일부만 바꾸는 예를 들어 회원 정보를 수집할 때 아이디만 바꾸는 경우 patch를 사용하는 것이 더욱 REST한 방법입니다. 당연히 PUT으로 보내도 서버에서 아이디만 바꾸면 되긴 합니다. 다만, RESTFULL 하게 만드려면 PATCH를 통해 하는 것이 좋겠죠?

**데이터 전송:**

- **PUT**: 요청 본문에 전체 리소스 데이터를 포함합니다.
- **PATCH**: 업데이트할 리소스의 일부만 포함하는 요청 본문을 사용합니다.

만약 리소스가 기기에서 전부를 컨트롤 하고 있고 특정 부분만 잘라서 줄 수 도 있습니다. 이런 경우를 이야기하는 것 입니다. 사실 HTTP 자체는 연속성을 지니지 않기 때문에 앞에 10줄짜리 소스에서 2줄짜리 뽑아서 데이터를 전송하는데 둘다 PUT으로 보내도 알 수 있는 방법이 없습니다.

그래서 더 정확히 구분해서 개발자들끼리 서로 정확히 이해하고 API에 대해 생각하는 시간 자체를 줄여줄 수 도 있습니다.

**멱등성:**

- **PUT**: 멱등성을 지닙니다. 즉, 동일한 요청을 여러 번 반복해도 리소스 상태는 동일하게 변경됩니다.
- **PATCH**: 일반적으로 멱등성을 보장하지 않습니다. 즉, 동일한 요청을 여러 번 반복하면 리소스 상태가 예상치 못한 방식으로 변경될 수 있습니다.

멱등성은 **동일한 작업을 반복해도 결과가 동일한 특성**을 의미합니다. 즉, **처음 수행한 작업과 동일한 효과를 얻기 위해 추가적인 작업이 필요하지 않음**을 나타냅니다.
 2 + 2 = 4는 멱등한 연산이라고 할 수 있겠죠. 어떤 천재 수학자가 와도 2더하기 2는 4입니다.

**결론:**

- **PUT**은 전체 리소스를 대체하는 데 사용되는 **완전 업데이트** 메서드입니다.
- **PATCH**는 리소스의 일부만 업데이트하는 데 사용되는 **부분 업데이트** 메서드입니다.

적절한 메서드 선택은 업데이트하려는 데이터의 양, 리소스의 전체 상태에 대한 지식, 멱등성 요구 사항에 따라 달라집니다.

- **전체 리소스를 새 데이터로 완전히 대체해야 하고 리소스의 전체 상태를 알고 있는 경우 PUT을 사용하는 것이 좋습니다.**
- **리소스의 일부만 업데이트해야 하고 리소스의 전체 상태를 알 필요가 없는 경우 PATCH를 사용하는 것이 좋습니다.**